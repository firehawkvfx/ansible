- name: 'create a new ebs volume'
  debug:
    msg: "create a new ebs volume {{ item.item.int }} {{ item.item.path }}"

- name: create ebs volume
  ec2_vol:
    region: "{{ aws_region }}"
    instance: "{{ instance_id }}"
    name: "softnas_volume_{{ item.item.int }}"
    volume_size: "{{ item.item.ebs_disk_size }}"
    volume_type: "{{ item.item.ebs_disk_type }}"
    device_name: "{{ item.item.path }}"
    delete_on_termination: "{{ item.item.volatile }}"
    tags:
      role: Softnas
      mount: "{{ item.item.path }}"
      pool: "{{ item.item.pool_name }}"
      volatile: "{{ item.item.volatile }}"
